{"type":"operationStart","subtype":"profile","data":{"_id":"GQeWGtNbg1CXfilU","timestamp":"2024-01-09T19:41:24.971Z","state":"queued","mode":"full","creationDate":"2024-01-09T19:41:24.974Z","modificationDate":"2024-01-09T19:41:24.974Z","shortid":"1IKwhAh","$entitySet":"profiles"},"doDiffs":false,"timestamp":1704829284972,"id":"uir597ia5xameo8","previousOperationId":null,"operationId":"m7hc1pa19dyo81t"}
{"type":"log","level":"info","message":"Render request 8 queued for execution and waiting for available worker","previousOperationId":"m7hc1pa19dyo81t","timestamp":1704829284973,"id":"mrgqwi7nwy4troy"}
{"type":"operationStart","subtype":"render","name":"sales-main","previousOperationId":"m7hc1pa19dyo81t","timestamp":1704829284986,"id":"8foetuyclz6rgi1","previousEventId":"uir597ia5xameo8","operationId":"qoi68mcxuqjbufb","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n@@ -1,0 +1,1 @@\n\\ No newline at end of file\n+{}\n\\ No newline at end of file\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n@@ -1,0 +1,25 @@\n\\ No newline at end of file\n+{\n+  \"template\": {\n+    \"name\": \"sales-main\",\n+    \"recipe\": \"html-to-xlsx\",\n+    \"shortid\": \"B1Q2SFTNr\",\n+    \"folder\": {\n+      \"shortid\": \"FnHe~Wz\"\n+    },\n+    \"engine\": \"handlebars\",\n+    \"chrome\": {\n+      \"printBackground\": true\n+    },\n+    \"htmlToXlsx\": {\n+      \"htmlEngine\": \"chrome\"\n+    },\n+    \"data\": {\n+      \"shortid\": \"B1lSTrt6NB\"\n+    },\n+    \"content\": \"<!--\\nExample for html-to-xlsx conversion\\nNote: This example requires jsreport to be configured with\\n{ \\\"trustUserCode\\\": true } or\\n{ \\\"sandbox\\\": { \\\"allowedModules\\\": [\\\"moment\\\"] } }\\n!-->\\n<html>\\n    <head>\\n        <style>\\n            {{asset \\\"sales-styles.css\\\" \\\"utf8\\\"}}\\n        </style>\\n    </head>\\n    <body>\\n        <table name=\\\"Sales-Detail\\\">\\n            <tbody class=\\\"head\\\">\\n                <tr>\\n                    <td></td>\\n                    <td colspan=\\\"5\\\" class=\\\"title\\\">SALES DETAIL</td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 7}}\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 1}}\\n                    <td class=\\\"label content border-top border-left\\\">Customer</td>\\n                    <td class=\\\"content border-top\\\">{{customer}}</td>\\n                    {{generateEmptyCell 1 \\\"content border-top\\\"}}\\n                    <td class=\\\"label content border-top\\\">Report Date</td>\\n                    <td class=\\\"content border-top border-right t-right\\\" data-cell-type=\\\"date\\\" data-cell-format-str=\\\"dd-mm-yyyy\\\">{{nowStr}}</td>\\n                    {{generateEmptyCell 1}}\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 1}}\\n                    <td class=\\\"label content border-bottom border-left\\\">Month</td>\\n                    <td class=\\\"content border-bottom\\\">{{month}}</td>\\n                    {{generateEmptyCell 1 \\\"content border-bottom\\\"}}\\n                    <td class=\\\"label content border-bottom\\\">Tax</td>\\n                    <!-- enum = \\\"9\\\" percentage -->\\n                    <td class=\\\"content border-bottom border-right t-right\\\" data-cell-type=\\\"number\\\" data-cell-format-enum=\\\"9\\\">{{taxPercentage}}</td>\\n                    {{generateEmptyCell 1}}\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 7}}\\n                </tr>\\n            </tbody>\\n            <tbody class=\\\"detail\\\">\\n                <tr>\\n                    <th class=\\\"t-center\\\">Date</th>\\n                    <th class=\\\"t-left\\\">Product</th>\\n                    <th class=\\\"t-left\\\">Category</th>\\n                    <th class=\\\"t-right\\\">Unit Price</th>\\n                    <th class=\\\"t-right\\\">Quantity</th>\\n                    <th class=\\\"t-right\\\">Discount</th>\\n                    <th class=\\\"t-right\\\">Amount</th>\\n                </tr>\\n                {{#each detail}}\\n                    <tr class=\\\"{{oddClassName @index}}\\\">\\n                        <td class=\\\"t-center\\\" data-cell-type=\\\"date\\\" data-cell-format-str=\\\"dd-mm-yyyy\\\">{{date}}</td>\\n                        <td>{{product}}</td>\\n                        <td>{{category}}</td>\\n                        <td class=\\\"t-right\\\" data-cell-type=\\\"number\\\">{{unitPrice}}</td>\\n                        <td class=\\\"t-right\\\" data-cell-type=\\\"number\\\">{{quantity}}</td>\\n                        <td class=\\\"t-right\\\" data-cell-type=\\\"number\\\" data-cell-format-enum=\\\"9\\\">{{discountPercentage}}</td>\\n                        <td class=\\\"t-right\\\" data-cell-type=\\\"formula\\\">=(D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}) - (D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}*F{{getDetailRowIndex @index}})</td>\\n                    </tr>\\n                {{/each}}\\n                <tr>\\n                    {{generateEmptyCell 5}}\\n                    <td class=\\\"label\\\">Total Net Amount $</td>\\n                    <td class=\\\"t-right\\\" data-cell-type=\\\"formula\\\">=SUM(G{{getDetailRowIndex 0}}:G{{getDetailRowIndex (sum detail.length -1)}})</td>\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 5}}\\n                    <td class=\\\"label\\\" data-cell-type=\\\"formula\\\" data-cell-format-enum=\\\"2\\\">=CONCATENATE(\\\"VAT (\\\", F4*100, \\\"%)\\\", \\\" $\\\")</td>\\n                    <td class=\\\"t-right\\\" data-cell-type=\\\"formula\\\" data-cell-format-enum=\\\"2\\\">=G{{getDetailRowIndex detail.length}}*F4</td>\\n                </tr>\\n                <tr>\\n                    {{generateEmptyCell 5}}\\n                    <td class=\\\"label\\\">Total $</td>\\n                    <td class=\\\"t-right\\\" data-cell-type=\\\"formula\\\" data-cell-format-enum=\\\"2\\\">=SUM(G{{getDetailRowIndex detail.length}}:GG{{getDetailRowIndex (sum detail.length 1)}})</td>\\n                </tr>\\n            </tbody>\\n        </table>\\n    </body>\\n</html>\\n\",\n+    \"helpers\": \"const moment = require('moment')\\nconst rowOffset = 6\\n\\nfunction nowStr () {\\n    return moment().format('YYYY-MM-DD')\\n}\\n\\nfunction generateEmptyCell (repeat, className) {\\n    const cells = []\\n\\n    for (let i = 0; i < repeat; i++) {\\n        cells.push(`<td class=\\\"empty-cell ${className || ''}\\\"></td>`)\\n    }\\n\\n    return new Handlebars.SafeString(cells.join(''))\\n}\\n\\nfunction oddClassName (index) {\\n    return (index + 1) % 2 !== 0 ? 'odd' : ''\\n}\\n\\nfunction sum (a, b) {\\n    return a + b\\n}\\n\\nfunction getDetailRowIndex (index) {\\n    return (index + 1) + rowOffset\\n}\",\n+    \"creationDate\": \"2024-01-09T19:17:55.454Z\",\n+    \"modificationDate\": \"2024-01-09T19:17:55.454Z\"\n+  },\n+  \"data\": {}\n+}\n\\ No newline at end of file\n"}}
{"type":"log","timestamp":1704829284991,"level":"info","message":"Starting rendering request 8","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"hegyisbv9emgk4u","previousOperationId":"qoi68mcxuqjbufb"}
{"type":"log","timestamp":1704829284991,"level":"info","message":"Rendering template { name: sales-main, recipe: html-to-xlsx, engine: handlebars, preview: true }","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"kcku3sfh54gyy14","previousOperationId":"qoi68mcxuqjbufb"}
{"type":"log","timestamp":1704829284993,"level":"debug","message":"Adding sample data B1lSTrt6NB","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"m10kkg7f9jehlzf","previousOperationId":"qoi68mcxuqjbufb"}
{"type":"log","timestamp":1704829284997,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"3mn4nla3wt97g25","previousOperationId":"qoi68mcxuqjbufb"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1704829284997,"id":"jv3myqj924wr9qy","previousEventId":"8foetuyclz6rgi1","operationId":"7z2xlsbktst3bs2","previousOperationId":"qoi68mcxuqjbufb","res":{"content":null,"meta":{"diff":"Index: resMeta\n===================================================================\n--- resMeta\n+++ resMeta\n@@ -1,1 +1,1 @@\n-{}\n\\ No newline at end of file\n+{\"reportName\":\"sales-main\",\"headers\":{}}\n\\ No newline at end of file\n"}},"req":{"diff":"Index: req\n===================================================================\n--- req\n+++ req\n@@ -3,3 +3,0 @@\n-    \"name\": \"sales-main\",\n-    \"recipe\": \"html-to-xlsx\",\n-    \"shortid\": \"B1Q2SFTNr\",\n@@ -9,0 +6,3 @@\n+    \"shortid\": \"B1Q2SFTNr\",\n+    \"name\": \"sales-main\",\n+    \"recipe\": \"html-to-xlsx\",\n@@ -22,1 +22,3 @@\n-    \"modificationDate\": \"2024-01-09T19:17:55.454Z\"\n+    \"modificationDate\": \"2024-01-09T19:17:55.454Z\",\n+    \"_id\": \"VfOhoT897nIpkSyp\",\n+    \"scripts\": []\n@@ -24,1 +26,81 @@\n-  \"data\": {}\n+  \"data\": {\n+    \"customer\": \"Walker Group\",\n+    \"month\": \"April\",\n+    \"taxPercentage\": 0.2,\n+    \"detail\": [\n+      {\n+        \"date\": \"2019-04-03\",\n+        \"product\": \"Vitamin C\",\n+        \"category\": \"Health\",\n+        \"unitPrice\": 25,\n+        \"quantity\": 1,\n+        \"discountPercentage\": 0\n+      },\n+      {\n+        \"date\": \"2019-04-03\",\n+        \"product\": \"Probiotics\",\n+        \"category\": \"Health\",\n+        \"unitPrice\": 83,\n+        \"quantity\": 1,\n+        \"discountPercentage\": 0.25\n+      },\n+      {\n+        \"date\": \"2019-04-04\",\n+        \"product\": \"Mild Bubble Cleanser\",\n+        \"category\": \"Cleansing\",\n+        \"unitPrice\": 13,\n+        \"quantity\": 2,\n+        \"discountPercentage\": 0\n+      },\n+      {\n+        \"date\": \"2019-04-04\",\n+        \"product\": \"Deep Cleanser\",\n+        \"category\": \"Cleansing\",\n+        \"unitPrice\": 12,\n+        \"quantity\": 3,\n+        \"discountPercentage\": 0\n+      },\n+      {\n+        \"date\": \"2019-04-04\",\n+        \"product\": \"Atomy Men Set\",\n+        \"category\": \"Men Skin Care\",\n+        \"unitPrice\": 54,\n+        \"quantity\": 1,\n+        \"discountPercentage\": 0.35\n+      },\n+      {\n+        \"date\": \"2019-04-09\",\n+        \"product\": \"BB Cream\",\n+        \"category\": \"Make-Up\",\n+        \"unitPrice\": 12,\n+        \"quantity\": 3,\n+        \"discountPercentage\": 0\n+      },\n+      {\n+        \"date\": \"2019-04-15\",\n+        \"product\": \"Lipstick Poppy\",\n+        \"category\": \"Make-Up\",\n+        \"unitPrice\": 22,\n+        \"quantity\": 1,\n+        \"discountPercentage\": 0\n+      },\n+      {\n+        \"date\": \"2019-04-15\",\n+        \"product\": \"Healthy Glow Base\",\n+        \"category\": \"Make-Up\",\n+        \"unitPrice\": 18,\n+        \"quantity\": 2,\n+        \"discountPercentage\": 0.12\n+      },\n+      {\n+        \"date\": \"2019-04-26\",\n+        \"product\": \"Lotion\",\n+        \"category\": \"Skin Care\",\n+        \"unitPrice\": 23,\n+        \"quantity\": 1,\n+        \"discountPercentage\": 0\n+      }\n+    ],\n+    \"$tempAutoCleanupDirectory\": \"C:\\\\Users\\\\arida\\\\AppData\\\\Local\\\\Temp\\\\jsreport\\\\autocleanup\",\n+    \"$writeToFiles\": true\n+  }\n"}}
{"type":"log","timestamp":1704829285000,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"1i4kuqp0dnpq1oz","previousOperationId":"7z2xlsbktst3bs2"}
{"type":"log","timestamp":1704829285085,"level":"warn","message":"Error when processing render request 8\n(because) error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n\nError: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\requireSandbox.js:53:19)\n  at Object.require (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n  at async executeEngine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:287:14)\n  at async engine.engine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n  at WorkerReporter.createError (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:49:12)\n  at executeEngine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:310:33)\n  at async engine.engine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"dksuch35ivxpvbm","previousOperationId":"7z2xlsbktst3bs2"}
{"type":"log","timestamp":1704829285085,"level":"warn","message":"Rendering request 8 finished with error in 114 ms","meta":{"rootId":"dbvn7i0q8h2a0rl","id":"dbvn7i0q8h2a0rl"},"id":"8jrch9sxthbdp0y","previousOperationId":"7z2xlsbktst3bs2"}
{"type":"error","timestamp":1704829285102,"entity":{"shortid":"B1Q2SFTNr","name":"sales-main","content":"<!--\nExample for html-to-xlsx conversion\nNote: This example requires jsreport to be configured with\n{ \"trustUserCode\": true } or\n{ \"sandbox\": { \"allowedModules\": [\"moment\"] } }\n!-->\n<html>\n    <head>\n        <style>\n            {{asset \"sales-styles.css\" \"utf8\"}}\n        </style>\n    </head>\n    <body>\n        <table name=\"Sales-Detail\">\n            <tbody class=\"head\">\n                <tr>\n                    <td></td>\n                    <td colspan=\"5\" class=\"title\">SALES DETAIL</td>\n                    <td></td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 7}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 1}}\n                    <td class=\"label content border-top border-left\">Customer</td>\n                    <td class=\"content border-top\">{{customer}}</td>\n                    {{generateEmptyCell 1 \"content border-top\"}}\n                    <td class=\"label content border-top\">Report Date</td>\n                    <td class=\"content border-top border-right t-right\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{nowStr}}</td>\n                    {{generateEmptyCell 1}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 1}}\n                    <td class=\"label content border-bottom border-left\">Month</td>\n                    <td class=\"content border-bottom\">{{month}}</td>\n                    {{generateEmptyCell 1 \"content border-bottom\"}}\n                    <td class=\"label content border-bottom\">Tax</td>\n                    <!-- enum = \"9\" percentage -->\n                    <td class=\"content border-bottom border-right t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{taxPercentage}}</td>\n                    {{generateEmptyCell 1}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 7}}\n                </tr>\n            </tbody>\n            <tbody class=\"detail\">\n                <tr>\n                    <th class=\"t-center\">Date</th>\n                    <th class=\"t-left\">Product</th>\n                    <th class=\"t-left\">Category</th>\n                    <th class=\"t-right\">Unit Price</th>\n                    <th class=\"t-right\">Quantity</th>\n                    <th class=\"t-right\">Discount</th>\n                    <th class=\"t-right\">Amount</th>\n                </tr>\n                {{#each detail}}\n                    <tr class=\"{{oddClassName @index}}\">\n                        <td class=\"t-center\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{date}}</td>\n                        <td>{{product}}</td>\n                        <td>{{category}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\">{{unitPrice}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\">{{quantity}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{discountPercentage}}</td>\n                        <td class=\"t-right\" data-cell-type=\"formula\">=(D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}) - (D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}*F{{getDetailRowIndex @index}})</td>\n                    </tr>\n                {{/each}}\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\">Total Net Amount $</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\">=SUM(G{{getDetailRowIndex 0}}:G{{getDetailRowIndex (sum detail.length -1)}})</td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=CONCATENATE(\"VAT (\", F4*100, \"%)\", \" $\")</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=G{{getDetailRowIndex detail.length}}*F4</td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\">Total $</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=SUM(G{{getDetailRowIndex detail.length}}:GG{{getDetailRowIndex (sum detail.length 1)}})</td>\n                </tr>\n            </tbody>\n        </table>\n    </body>\n</html>\n"},"property":"helpers","statusCode":400,"weak":true,"logged":true,"previousOperationId":"7z2xlsbktst3bs2","id":"umpge1nrxzq17cp","stack":"Error: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\requireSandbox.js:53:19)\n  at Object.require (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n  at async executeEngine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:287:14)\n  at async engine.engine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n  at WorkerReporter.createError (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:49:12)\n  at executeEngine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:310:33)\n  at async engine.engine (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\arida\\Dev\\2DAM\\EventFlow\\jsreportapp\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","message":"Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n"}
